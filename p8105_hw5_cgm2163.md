Homework 5
================

**Set up**

## Problem 1

This data was collected from the Washington Post regarding homicides in
50 large US cities. The data details a number of cases and their status,
whether they were closed by arrest, closed with no arrest, or open/no
arrest.

We can read in the data from the Washington Post to learn more.

``` r
homicide_data = 
  read_csv("./homicide-data.csv") %>%
  mutate(
    city_state = str_c(city, state, sep = "_"),
    resolved = case_when(
        disposition == "Closed without arrest" ~ "unsolved",
        disposition == "Open/No arrest"        ~ "unsolved",
        disposition == "Closed by arrest"      ~ "solved",
      
    )
  ) %>%
  select(city_state, resolved) %>%
  filter(city_state != "Tulsa_AL")
```

    ## Rows: 52179 Columns: 12

    ## ── Column specification ────────────────────────────────────────────────────────
    ## Delimiter: ","
    ## chr (9): uid, victim_last, victim_first, victim_race, victim_age, victim_sex...
    ## dbl (3): reported_date, lat, lon

    ## 
    ## ℹ Use `spec()` to retrieve the full column specification for this data.
    ## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.

``` r
view(homicide_data)
```

now we can see how many homicides and how many unsolved homicides are in
each city

``` r
summary_data = 
  homicide_data %>%
  group_by(city_state) %>%
  summarize(
    hom_total = n(),
    hom_unsolved = sum(resolved == "unsolved")
  )
  
view(summary_data)
```

Let’s look at our Baltimore data!

``` r
baltimore_prop_test =
  prop.test(
  summary_data %>%
    filter(city_state == "Baltimore_MD") %>%
    pull(hom_unsolved),
    summary_data %>%
      filter(city_state == "Baltimore_MD") %>%
        pull(hom_total))


baltimore_prop_test %>%
  broom::tidy() %>%
  knitr::kable()
```

|  estimate | statistic | p.value | parameter |  conf.low | conf.high | method                                               | alternative |
|----------:|----------:|--------:|----------:|----------:|----------:|:-----------------------------------------------------|:------------|
| 0.6455607 |   239.011 |       0 |         1 | 0.6275625 | 0.6631599 | 1-sample proportions test with continuity correction | two.sided   |

For Baltimore, Maryland, the estimated proportion of homicides that are
unsolved is 0.646. The confidence interval around this is (0.628,
0.663), meaning that we are 95% sure that the true proportion of
homicides that are unsolved is between 0.628 and 0.663.

We can now do the same analysis for all of the cities in our data frame:

``` r
prop_test_cities = 
  function(homicide_data){
    cities = 
      homicide_data %>%
      summarize(
        unsolved = sum(resolved == "unsolved"),
        count = n()
      )
    
    cities_test = 
      prop.test(
        x = cities %>%
          pull(unsolved),
        n = cities %>%
          pull(count)
      )
    
    
    return(cities_test)
    
  }

cities_test_results = 
  homicide_data %>%
    nest(data = resolved) %>%
    mutate(
      test_results = map(data, prop_test_cities),
      tidy_output = map(test_results, broom::tidy)
    ) %>%
  select(city_state, tidy_output) %>%
  unnest(tidy_output) %>%
  select(city_state, estimate, starts_with("conf"))

head(cities_test_results) %>%
  knitr::kable()
```

| city\_state     |  estimate |  conf.low | conf.high |
|:----------------|----------:|----------:|----------:|
| Albuquerque\_NM | 0.3862434 | 0.3372604 | 0.4375766 |
| Atlanta\_GA     | 0.3833505 | 0.3528119 | 0.4148219 |
| Baltimore\_MD   | 0.6455607 | 0.6275625 | 0.6631599 |
| Baton Rouge\_LA | 0.4622642 | 0.4141987 | 0.5110240 |
| Birmingham\_AL  | 0.4337500 | 0.3991889 | 0.4689557 |
| Boston\_MA      | 0.5048860 | 0.4646219 | 0.5450881 |

graph!

``` r
cities_test_results %>%
  mutate(city_state = fct_reorder(city_state, estimate)) %>%
  ggplot(aes(x = city_state, y = estimate)) + geom_point() + geom_errorbar(
    aes(ymin = conf.low, ymax = conf.high)) + theme(axis.text.x = element_text(
      angle = 90, vjust = 0.5, hjust = 1))
```

<img src="p8105_hw5_cgm2163_files/figure-gfm/unnamed-chunk-5-1.png" width="90%" />

## Problem 2
